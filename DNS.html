<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cyber Security Solutions for the Future.">
    <title>PARLAR | DNS Checker</title>
    <link rel="icon" href="P-favicon.png" type="image/jpeg">
    <link rel="stylesheet" href="styles.css">
    <script defer src="scripts.js"></script>
</head>
<body>
<header>
    <h1>PARLAR</h1>
    <p>CYBER SECURITY - INFORMATION SECURITY - OPERATIONAL SECURITY</p>
</header>


   <nav>
      <button class="nav-toggle" aria-label="Toggle navigation">&#9776;</button>
      <div class="nav-links">
          <a href="index.html">Home</a>
          <a href="DNS.html">DNS Checker</a>
          <a href="godark.html">Go Dark</a>
      </div>
  </nav>

  <style>
   hr {
       width: 50%;
     border: 0;
     height: 2px;
     background-color: #00000085;
   }
 </style>

<script>
   document.addEventListener('DOMContentLoaded', () => {
       const navToggle = document.querySelector('.nav-toggle');
       const navLinks = document.querySelector('.nav-links');

       navToggle.addEventListener('click', () => {
           navLinks.classList.toggle('active');
       });

       const consoleElement = document.getElementById('console');
       const consoleOutput = document.getElementById('console-output');
   });
</script>

<section class="content" id="dns-checker">
   <h2>DNS Security Checker</h2>
   <p>Analyse your domain's DNS records and receive security recommendations<br><br></p>
   
   <div class="dns-checker-container">
      <div class="dns-form">
         <input type="text" id="domain-input" placeholder="Enter domain (e.g., example.com)" />
         <select id="record-type">
            <option value="ALL">All Records</option>
            <option value="A">A Record</option>
            <option value="AAAA">AAAA Record</option>
            <option value="CNAME">CNAME Record</option>
            <option value="MX">MX Record</option>
            <option value="TXT">TXT Record</option>
            <option value="NS">NS Record</option>
            <option value="SOA">SOA Record</option>
            <option value="DNSKEY">DNSKEY Record</option>
            <option value="DS">DS Record</option>
            <option value="DMARC">DMARC Record</option>
            <option value="SPF">SPF Record</option>
            <option value="DKIM">DKIM Record</option>
         </select>
         <button id="check-dns-btn">Check DNS</button>
      </div>

      <div id="api-message" class="message-box hidden">
         <p><strong>DNS API Access Required</strong></p>
         <p>This tool uses a public DNS API for lookups. Select a different provider if the current one isn't responding.</p>
         <select id="dns-api-select">
            <option value="cloudflare">Cloudflare DNS API</option>
            <option value="google">Google DNS API</option>
         </select>
      </div>

      <div class="dkim-selector hidden">
         <p>Enter DKIM selector (e.g., default, google, mail):</p>
         <div class="dkim-input-container">
            <input type="text" id="dkim-selector-input" placeholder="Enter DKIM selector" value="default" />
            <button id="add-selector-btn">Add</button>
         </div>
         <div id="dkim-selectors-list" class="selectors-list"></div>
         
         <!-- Common DKIM selectors by service -->
         <div class="common-selectors">
            <p>Common selectors by service (click to add):</p>
            <div class="selector-groups">
               <div class="selector-group">
                  <div class="selector-group-name">Google Workspace:</div>
                  <div class="quick-selectors">
                     <span class="quick-selector" data-selector="google">google</span>
                  </div>
               </div>
               <div class="selector-group">
                  <div class="selector-group-name">Common formats:</div>
                  <div class="quick-selectors">
                     <span class="quick-selector" data-selector="selector1">selector1</span>
                     <span class="quick-selector" data-selector="selector2">selector2</span>
                     <span class="quick-selector" data-selector="k1">k1</span>
                     <span class="quick-selector" data-selector="k2">k2</span>
                     <span class="quick-selector" data-selector="s1">s1</span>
                     <span class="quick-selector" data-selector="s2">s2</span>
                  </div>
               </div>
               <div class="selector-group">
                  <div class="selector-group-name">ProtonMail:</div>
                  <div class="quick-selectors">
                     <span class="quick-selector" data-selector="protonmail">protonmail</span>
                     <span class="quick-selector" data-selector="protonmail1">protonmail1</span>
                     <span class="quick-selector" data-selector="protonmail2">protonmail2</span>
                     <span class="quick-selector" data-selector="protonmail3">protonmail3</span>
                  </div>
               </div>
               <div class="selector-group">
                  <div class="selector-group-name">Constant Contact:</div>
                  <div class="quick-selectors">
                     <span class="quick-selector" data-selector="ctct1">ctct1</span>
                     <span class="quick-selector" data-selector="ctct2">ctct2</span>
                  </div>
               </div>
               <div class="selector-group">
                  <div class="selector-group-name">Zendesk:</div>
                  <div class="quick-selectors">
                     <span class="quick-selector" data-selector="zendesk1">zendesk1</span>
                     <span class="quick-selector" data-selector="zendesk2">zendesk2</span>
                  </div>
               </div>
               <div class="selector-group">
                  <div class="selector-group-name">Apple iCloud:</div>
                  <div class="quick-selectors">
                     <span class="quick-selector" data-selector="sig1">sig1</span>
                  </div>
               </div>
               <div class="selector-group">
                  <div class="selector-group-name">Other services:</div>
                  <div class="quick-selectors">
                     <span class="quick-selector" data-selector="default">default</span>
                     <span class="quick-selector" data-selector="mail">mail</span>
                     <span class="quick-selector" data-selector="email">email</span>
                     <span class="quick-selector" data-selector="dkim">dkim</span>
                     <span class="quick-selector" data-selector="litesrv">litesrv</span>
                     <span class="quick-selector" data-selector="sm">sm</span>
                  </div>
               </div>
            </div>
         </div>
      </div>

      <div id="loading-spinner" class="hidden">
         <div class="spinner"></div>
         <p>Analysing DNS records...</p>
      </div>

      <div id="dns-results" class="hidden">
         <div class="tabs">
            <button class="tab-btn active" data-tab="records">DNS Records</button>
            <button class="tab-btn" data-tab="recommendations">Recommendations</button>
            <button class="tab-btn" data-tab="raw">Raw Data</button>
         </div>
         
         <div class="tab-content active" id="records-tab">
            <h3>DNS Records</h3>
            <div id="records-list"></div>
         </div>
         
         <div class="tab-content" id="recommendations-tab">
            <h3>Security Recommendations</h3>
            <div id="recommendations-list"></div>
         </div>
         
         <div class="tab-content" id="raw-tab">
            <h3>Raw DNS Data</h3>
            <pre id="raw-data"></pre>
         </div>
      </div>
   </div>

   <style>
      /* DNS Checker Styles - Sleek Update with Black and Teal */
      #dns-checker {
         padding: 20px;
         margin-bottom: 30px;
         text-align: center; /* Center all content in DNS checker */
      }
      
      #dns-checker h2, #dns-checker p, #dns-checker h3 {
         text-align: center;
      }
      
      .dns-checker-container {
         background: rgba(10, 12, 15, 0.92);
         border-radius: 12px;
         padding: 25px;
         box-shadow: 0 8px 20px rgba(0, 240, 255, 0.15);
         border: 1px solid rgba(0, 240, 255, 0.2);
         position: relative;
         overflow: hidden;
      }
      
      .dns-checker-container::before {
         content: '';
         position: absolute;
         top: 0;
         left: 0;
         width: 100%;
         height: 2px;
         background: linear-gradient(90deg, rgba(0, 240, 255, 0), rgba(0, 240, 255, 0.7), rgba(0, 240, 255, 0));
         z-index: 1;
      }
      
      .dns-form {
         display: flex;
         flex-wrap: wrap;
         gap: 10px;
         margin-bottom: 20px;
         position: relative;
         z-index: 2;
         justify-content: center; /* Center form elements */
      }
      
      #domain-input {
         flex: 1;
         min-width: 200px;
         padding: 14px;
         border-radius: 6px;
         border: 1px solid rgba(0, 240, 255, 0.3);
         background: rgba(5, 8, 12, 0.9);
         color: #fff;
         font-size: 16px;
         box-shadow: 0 0 10px rgba(0, 240, 255, 0.1) inset;
         transition: all 0.3s ease, box-shadow 0.5s ease;
      }
      
      #domain-input:focus {
         border-color: rgba(0, 240, 255, 0.8);
         box-shadow: 0 0 15px rgba(0, 240, 255, 0.3) inset;
         outline: none;
      }
      
      #record-type {
         padding: 14px;
         border-radius: 6px;
         border: 1px solid rgba(0, 240, 255, 0.3);
         background: rgba(5, 8, 12, 0.9);
         color: #fff;
         font-size: 16px;
         box-shadow: 0 0 10px rgba(0, 240, 255, 0.1) inset;
         transition: all 0.3s ease;
      }
      
      #record-type:focus {
         border-color: rgba(0, 240, 255, 0.8);
         outline: none;
      }
      
      #check-dns-btn {
         padding: 14px 28px;
         background: rgba(0, 240, 255, 0.8);
         color: black;
         border: none;
         border-radius: 6px;
         cursor: pointer;
         font-weight: bold;
         transition: all 0.3s ease;
         position: relative;
         overflow: hidden;
         box-shadow: 0 4px 12px rgba(0, 240, 255, 0.2);
      }
      
      #check-dns-btn::after {
         content: '';
         position: absolute;
         top: -50%;
         left: -50%;
         width: 200%;
         height: 200%;
         background: linear-gradient(45deg, rgba(255, 255, 255, 0) 30%, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0) 70%);
         transform: rotate(45deg);
         transition: all 0.8s cubic-bezier(0.19, 1, 0.22, 1);
         opacity: 0;
      }
      
      #check-dns-btn:hover {
         background: rgba(0, 240, 255, 1);
         transform: translateY(-2px);
         box-shadow: 0 6px 16px rgba(0, 240, 255, 0.3);
      }
      
      #check-dns-btn:hover::after {
         opacity: 1;
         left: 100%;
      }
      
      #dns-results {
         background: rgba(5, 8, 12, 0.9);
         border-radius: 10px;
         padding: 20px;
         border: 1px solid rgba(0, 240, 255, 0.15);
         box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
         text-align: center;
      }
      
      .tabs {
         display: flex;
         border-bottom: 1px solid rgba(0, 240, 255, 0.2);
         margin-bottom: 15px;
         flex-wrap: wrap;
         justify-content: center;
      }
      
      .tab-btn {
         background: transparent;
         border: none;
         padding: 12px 22px;
         color: rgba(255, 255, 255, 0.6);
         cursor: pointer;
         transition: all 0.3s ease;
         font-size: 16px;
         position: relative;
      }
      
      .tab-btn::after {
         content: '';
         position: absolute;
         bottom: -1px;
         left: 50%;
         transform: translateX(-50%) scaleX(0);
         width: 80%;
         height: 2px;
         background: linear-gradient(90deg, rgba(0, 240, 255, 0), rgba(0, 240, 255, 1), rgba(0, 240, 255, 0));
         transition: transform 0.3s ease;
      }
      
      .tab-btn.active {
         color: #fff;
      }
      
      .tab-btn:hover::after {
         transform: translateX(-50%) scaleX(0.5);
      }
      
      .tab-btn.active::after {
         transform: translateX(-50%) scaleX(1);
      }
      
      .tab-content {
         display: none;
         opacity: 0;
         transition: opacity 0.5s ease;
      }
      
      .tab-content.active {
         display: block;
         opacity: 1;
         animation: fadeIn 0.5s ease forwards;
      }
      
      @keyframes fadeIn {
         from { opacity: 0; transform: translateY(5px); }
         to { opacity: 1; transform: translateY(0); }
      }
      
      .record-item {
         margin: 0 auto 15px;
         padding: 15px;
         border-radius: 8px;
         background: rgba(8, 12, 18, 0.7);
         border: 1px solid rgba(0, 240, 255, 0.12);
         transition: all 0.3s ease;
         position: relative;
         overflow: hidden;
         max-width: 95%;
         text-align: center;
      }
      
      .record-item:hover {
         box-shadow: 0 5px 15px rgba(0, 240, 255, 0.07);
         border-color: rgba(0, 240, 255, 0.2);
      }
      
      .record-item h4 {
         margin-top: 0;
         color: #00f0ff;
      }
      
      .record-item p {
         margin: 8px auto;
         text-align: center;
      }
      
      .record-value {
         font-family: 'Consolas', monospace;
         background: rgba(0, 0, 0, 0.5);
         padding: 12px;
         border-radius: 6px;
         overflow-wrap: break-word;
         border: 1px solid rgba(0, 240, 255, 0.1);
         box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) inset;
         margin: 5px auto; /* Center horizontally */
         max-width: 95%;
      }
      
      .recommendation-item {
         text-align: center;
         margin: 0 auto 25px;
         padding: 22px;
         border-radius: 8px;
         background: rgba(8, 12, 18, 0.7);
         border: 1px solid rgba(0, 240, 255, 0.12);
         transition: all 0.3s ease;
         display: flex;
         flex-direction: column;
         align-items: center;
         max-width: 90%;
      }
      
      .recommendation-item:hover {
         box-shadow: 0 5px 15px rgba(0, 240, 255, 0.07);
         transform: translateY(-2px);
      }
      
      .recommendation-icon {
         font-size: 30px;
         margin-bottom: 15px;
         text-align: center;
         width: 100%;
      }
      
      .recommendation-content {
         width: 100%;
         text-align: center;
      }
      
      .recommendation-content h4 {
         margin-top: 0;
         margin-bottom: 15px;
         color: #00f0ff;
         font-size: 18px;
         text-align: center;
      }
      
      .recommendation-content p {
         margin: 8px auto;
         line-height: 1.6;
         text-align: center;
         max-width: 85%;
      }
      
      .error { color: #ff4d4d; text-shadow: 0 0 8px rgba(255, 77, 77, 0.3); }
      .warning { color: #ffcc00; text-shadow: 0 0 8px rgba(255, 204, 0, 0.3); }
      .success { color: #00cc66; text-shadow: 0 0 8px rgba(0, 204, 102, 0.3); }
      .info { color: #00f0ff; text-shadow: 0 0 8px rgba(0, 240, 255, 0.3); }
      
      #raw-data {
         background: rgba(0, 0, 0, 0.5);
         padding: 15px;
         border-radius: 6px;
         overflow-x: auto;
         color: #ddd;
         font-family: 'Consolas', monospace;
         font-size: 14px;
         border: 1px solid rgba(0, 240, 255, 0.1);
         box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) inset;
         line-height: 1.5;
         margin: 0 auto;
         text-align: left; /* Keep raw data left-aligned for readability */
      }
      
      .hidden {
         display: none !important;
      }
      
      .spinner {
         width: 50px;
         height: 50px;
         border: 3px solid rgba(0, 240, 255, 0.07);
         border-radius: 50%;
         border-top: 3px solid #00f0ff;
         animation: spin 1s linear infinite;
         margin: 0 auto 20px;
         box-shadow: 0 0 15px rgba(0, 240, 255, 0.2);
      }
      
      @keyframes spin {
         0% { transform: rotate(0deg); }
         100% { transform: rotate(360deg); }
      }
      
      #loading-spinner p {
         text-align: center;
         color: rgba(255, 255, 255, 0.7);
         font-size: 16px;
         text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
         animation: pulse 1.5s infinite;
      }
      
      @keyframes pulse {
         0%, 100% { opacity: 0.7; }
         50% { opacity: 1; }
      }
      
      /* DKIM Selector Styles - Updated for Black and Teal */
      .dkim-selector {
         margin: 10px auto 15px; /* Center horizontally with auto margins */
         padding: 15px;
         background: rgba(8, 12, 18, 0.7);
         border-radius: 8px;
         border: 1px solid rgba(0, 240, 255, 0.2);
         text-align: center;
      }
      
      .dkim-input-container {
         display: flex;
         gap: 10px;
         margin: 0 auto 12px; /* Center horizontally */
         max-width: 500px; /* Limit width for better appearance */
         justify-content: center;
      }
      
      .dkim-input-container input {
         flex: 1;
         padding: 10px 12px;
         background: rgba(0, 0, 0, 0.5);
         border: 1px solid rgba(0, 240, 255, 0.2);
         border-radius: 6px;
         color: #fff;
         transition: all 0.3s ease;
      }
      
      .dkim-input-container input:focus {
         border-color: rgba(0, 240, 255, 0.6);
         outline: none;
         box-shadow: 0 0 10px rgba(0, 240, 255, 0.2);
      }
      
      .selectors-list {
         display: flex;
         flex-wrap: wrap;
         gap: 10px;
         margin: 12px auto 0;
         justify-content: center;
      }
      
      .selector-tag {
         background: rgba(0, 240, 255, 0.08);
         border: 1px solid rgba(0, 240, 255, 0.25);
         border-radius: 15px;
         padding: 6px 12px;
         display: flex;
         align-items: center;
         font-size: 14px;
         transition: all 0.3s ease;
         position: relative;
         overflow: hidden;
      }
      
      .selector-tag::before {
         content: '';
         position: absolute;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: linear-gradient(45deg, rgba(0, 240, 255, 0), rgba(0, 240, 255, 0.1), rgba(0, 240, 255, 0));
         z-index: 0;
         opacity: 0;
         transition: opacity 0.3s ease;
      }
      
      .selector-tag:hover::before {
         opacity: 1;
      }
      
      .remove-selector {
         background: none;
         border: none;
         color: #ff4d4d;
         margin-left: 8px;
         cursor: pointer;
         font-weight: bold;
         position: relative;
         z-index: 1;
         transition: all 0.3s ease;
      }
      
      .remove-selector:hover {
         color: #ff6666;
         text-shadow: 0 0 8px rgba(255, 77, 77, 0.5);
      }
      
      /* Common DKIM selectors styling */
      .common-selectors {
         margin: 15px auto 0;
         padding-top: 12px;
         border-top: 1px solid rgba(0, 240, 255, 0.15);
         text-align: center;
      }
      
      .common-selectors p {
         margin-bottom: 12px;
         font-size: 15px;
         color: rgba(255, 255, 255, 0.9);
      }
      
      .selector-groups {
         display: flex;
         flex-direction: column;
         gap: 12px;
         align-items: center;
      }
      
      .selector-group {
         margin-bottom: 5px;
         text-align: center;
      }
      
      .selector-group-name {
         font-size: 14px;
         color: rgba(0, 240, 255, 0.8);
         margin-bottom: 6px;
      }
      
      .quick-selectors {
         display: flex;
         flex-wrap: wrap;
         gap: 8px;
         margin: 0 auto 5px;
         justify-content: center;
      }
      
      .quick-selector {
         background: rgba(0, 240, 255, 0.08);
         border: 1px solid rgba(0, 240, 255, 0.2);
         border-radius: 12px;
         padding: 4px 10px;
         font-size: 13px;
         cursor: pointer;
         transition: all 0.2s ease;
      }
      
      .quick-selector:hover {
         background: rgba(0, 240, 255, 0.15);
         transform: translateY(-1px);
         box-shadow: 0 2px 5px rgba(0, 240, 255, 0.15);
      }
      
      /* Message box styles - Updated */
      .message-box {
         margin: 15px auto;
         padding: 18px;
         background: rgba(0, 240, 255, 0.05);
         border-left: 3px solid #00f0ff;
         border-radius: 6px;
         box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
         animation: slideIn 0.5s ease-out forwards;
         max-width: 90%;
         text-align: center;
      }
      
      @keyframes slideIn {
         from { opacity: 0; transform: translateY(-10px); }
         to { opacity: 1; transform: translateY(0); }
      }
      
      .message-box p {
         margin: 5px 0;
         line-height: 1.5;
      }
      
      .message-box select {
         padding: 10px;
         margin-top: 10px;
         border-radius: 6px;
         border: 1px solid rgba(0, 240, 255, 0.3);
         background: rgba(5, 8, 12, 0.9);
         color: #fff;
         transition: all 0.3s ease;
      }
      
      /* Error message */
      .error-message {
         background: rgba(255, 77, 77, 0.05);
         border-left: 3px solid #ff4d4d;
      }
      
      /* Additional styling for record types */
      .error-record {
         border-left: 3px solid #ff4d4d;
         box-shadow: 0 4px 12px rgba(255, 77, 77, 0.05);
      }
      
      .info-record {
         border-left: 3px solid #00f0ff;
         box-shadow: 0 4px 12px rgba(0, 240, 255, 0.05);
      }
      
      /* Improve record display */
      .record-value {
         white-space: pre-wrap;
         max-height: 200px;
         overflow-y: auto;
      }
      
      /* Responsive adjustments */
      @media (max-width: 768px) {
         .dns-form {
            flex-direction: column;
         }
         
         #domain-input, #record-type, #check-dns-btn {
            width: 100%;
         }
         
         .tab-btn {
            padding: 10px 15px;
            font-size: 14px;
         }
      }
   </style>

   <script>
      document.addEventListener('DOMContentLoaded', function() {
         const domainInput = document.getElementById('domain-input');
         const recordTypeSelect = document.getElementById('record-type');
         const checkButton = document.getElementById('check-dns-btn');
         const loadingSpinner = document.getElementById('loading-spinner');
         const dnsResults = document.getElementById('dns-results');
         const recordsList = document.getElementById('records-list');
         const recommendationsList = document.getElementById('recommendations-list');
         const rawData = document.getElementById('raw-data');
         const tabButtons = document.querySelectorAll('.tab-btn');
         const tabContents = document.querySelectorAll('.tab-content');
         const dkimSelectorSection = document.querySelector('.dkim-selector');
         const dkimSelectorInput = document.getElementById('dkim-selector-input');
         const addSelectorBtn = document.getElementById('add-selector-btn');
         const dkimSelectorsList = document.getElementById('dkim-selectors-list');
         const apiMessage = document.getElementById('api-message');
         const dnsApiSelect = document.getElementById('dns-api-select');
         
         // Store DKIM selectors
         let dkimSelectors = ['default'];
         
         // DNS API configuration
         let dnsApi = {
            provider: 'cloudflare',
            endpoints: {
               cloudflare: 'https://cloudflare-dns.com/dns-query',
               google: 'https://dns.google/resolve'
            }
         };
         
         // Listen for DNS API provider changes
         dnsApiSelect.addEventListener('change', function() {
            dnsApi.provider = this.value;
            console.log(`Switched to ${dnsApi.provider} DNS API`);
         });
         
         // Show/hide DKIM selector input when DKIM record type is selected
         recordTypeSelect.addEventListener('change', () => {
            if (recordTypeSelect.value === 'DKIM') {
               dkimSelectorSection.classList.remove('hidden');
               // Add default selector if list is empty
               if (dkimSelectors.length === 0) {
                  dkimSelectors.push('default');
               }
               renderDkimSelectors();
            } else {
               dkimSelectorSection.classList.add('hidden');
            }
         });
         
         // Add DKIM selector
         addSelectorBtn.addEventListener('click', () => {
            const selector = dkimSelectorInput.value.trim();
            if (selector && !dkimSelectors.includes(selector)) {
               dkimSelectors.push(selector);
               dkimSelectorInput.value = '';
               renderDkimSelectors();
            }
         });
         
         // Add DKIM selector with Enter key
         dkimSelectorInput.addEventListener('keyup', function(event) {
            if (event.key === "Enter") {
               const selector = this.value.trim();
               if (selector && !dkimSelectors.includes(selector)) {
                  dkimSelectors.push(selector);
                  this.value = '';
                  renderDkimSelectors();
               }
            }
         });
         
         // Render DKIM selectors as tags
         function renderDkimSelectors() {
            dkimSelectorsList.innerHTML = '';
            
            dkimSelectors.forEach(selector => {
               const tag = document.createElement('div');
               tag.className = 'selector-tag';
               tag.innerHTML = `
                  ${selector}
                  <button class="remove-selector" data-selector="${selector}">Ã—</button>
               `;
               dkimSelectorsList.appendChild(tag);
            });
            
            // Add event listeners to remove buttons
            document.querySelectorAll('.remove-selector').forEach(btn => {
               btn.addEventListener('click', () => {
                  const selectorToRemove = btn.dataset.selector;
                  dkimSelectors = dkimSelectors.filter(s => s !== selectorToRemove);
                  renderDkimSelectors();
               });
            });
         }
         
         // Initial render of default selector
         renderDkimSelectors();
         
         // Set up tab switching
         tabButtons.forEach(button => {
            button.addEventListener('click', () => {
               const tab = button.dataset.tab;
               
               // Deactivate all tabs
               tabButtons.forEach(btn => btn.classList.remove('active'));
               tabContents.forEach(content => content.classList.remove('active'));
               
               // Activate selected tab
               button.classList.add('active');
               document.getElementById(`${tab}-tab`).classList.add('active');
            });
         });
         
         // DNS checking functionality
         checkButton.addEventListener('click', () => {
            const domain = domainInput.value.trim();
            const recordType = recordTypeSelect.value;
            
            if (!domain) {
               showError("Please enter a valid domain");
               return;
            }
            
            // Show loading spinner
            loadingSpinner.classList.remove('hidden');
            dnsResults.classList.add('hidden');
            apiMessage.classList.add('hidden');
            
            // Fetch DNS data
            fetchDnsData(domain, recordType)
               .then(data => {
                  displayDnsResults(data);
                  
                  // Hide spinner and show results
                  loadingSpinner.classList.add('hidden');
                  dnsResults.classList.remove('hidden');
               })
               .catch(error => {
                  console.error("Error fetching DNS data:", error);
                  showError(`Could not fetch DNS data: ${error.message}. Try switching the DNS API provider.`);
                  apiMessage.classList.remove('hidden');
                  loadingSpinner.classList.add('hidden');
               });
         });
         
         function showError(message) {
            const errorBox = document.createElement('div');
            errorBox.className = 'message-box error-message';
            errorBox.innerHTML = `<p><strong>Error:</strong> ${message}</p>`;
            
            // Insert at the top of results if visible, otherwise after the form
            if (!dnsResults.classList.contains('hidden')) {
               dnsResults.prepend(errorBox);
            } else {
               const insertAfter = apiMessage.classList.contains('hidden') ? 
                  document.querySelector('.dns-form') : apiMessage;
               insertAfter.parentNode.insertBefore(errorBox, insertAfter.nextSibling);
            }
            
            // Remove after 5 seconds
            setTimeout(() => {
               errorBox.style.opacity = '0';
               errorBox.style.transition = 'opacity 0.5s';
               setTimeout(() => errorBox.remove(), 500);
            }, 5000);
         }
         
         async function fetchDnsData(domain, recordType) {
            try {
               let records = [];
               let types = [];
               
               // Determine which types to query based on user selection
               if (recordType === 'ALL' || recordType === 'A') {
                  types.push('A');
               }
               if (recordType === 'ALL' || recordType === 'AAAA') {
                  types.push('AAAA');
               }
               if (recordType === 'ALL' || recordType === 'CNAME') {
                  types.push('CNAME');
               }
               if (recordType === 'ALL' || recordType === 'MX') {
                  types.push('MX');
               }
               if (recordType === 'ALL' || recordType === 'NS') {
                  types.push('NS');
               }
               if (recordType === 'ALL' || recordType === 'SOA') {
                  types.push('SOA');
               }
               if (recordType === 'ALL' || recordType === 'TXT' || recordType === 'SPF') {
                  types.push('TXT');
               }
               
               // Special handling for DMARC
               if (recordType === 'ALL' || recordType === 'DMARC') {
                  const dmarcDomain = `_dmarc.${domain}`;
                  await fetchRecordType(dmarcDomain, 'TXT', records, 'DMARC');
               }
               
               // Special handling for DKIM
               if (recordType === 'ALL' || recordType === 'DKIM') {
                  let dkimFound = false;
                  
                  // Create a progress indicator for multiple DKIM checks
                  if (dkimSelectors.length > 3 && recordType === 'DKIM') {
                     const progressNote = document.createElement('div');
                     progressNote.className = 'message-box';
                     progressNote.innerHTML = '<p>Checking multiple DKIM selectors. This may take a moment...</p>';
                     loadingSpinner.insertAdjacentElement('afterend', progressNote);
                     
                     // Remove after DKIM checks complete
                     setTimeout(() => {
                        progressNote.remove();
                     }, dkimSelectors.length * 500);
                  }
                  
                  for (const selector of dkimSelectors) {
                     const dkimDomain = `${selector}._domainkey.${domain}`;
                     const result = await fetchRecordType(dkimDomain, 'TXT', records, 'DKIM');
                     
                     // Check if a valid DKIM record was found
                     const validDkimFound = result.some(r => 
                        r.purpose === 'DKIM' && 
                        r.value.includes('v=DKIM1') && 
                        !r.status
                     );
                     
                     if (validDkimFound) {
                        dkimFound = true;
                     }
                  }
                  
                  // Provide a general note if no DKIM records found with any selector
                  if (!dkimFound) {
                     records.push({
                        type: 'TXT',
                        name: `hostname: *._domainkey`,
                        value: 'No valid DKIM records found with the provided selectors. Try adding common selectors like "default", "google", "selector1", or "selector2".',
                        ttl: 0,
                        purpose: 'DKIM',
                        status: 'info'
                     });
                  }
               }
               
               // Fetch standard record types
               for (const type of types) {
                  if (!(recordType === 'DKIM' && type === 'TXT') && 
                      !(recordType === 'DMARC' && type === 'TXT')) {
                     await fetchRecordType(domain, type, records);
                  }
               }
               
               // Generate recommendations based on real records
               const recommendations = generateRecommendations(records, domain);
               
               return {
                  domain: domain,
                  records: records,
                  recommendations: recommendations
               };
            } catch (error) {
               console.error("Error in fetchDnsData:", error);
               throw error;
            }
         }
         
         async function fetchRecordType(domain, type, recordsArray, purpose = null) {
            try {
               // Select API endpoint based on current provider
               const endpoint = dnsApi.endpoints[dnsApi.provider];
               const searchParams = new URLSearchParams({
                  name: domain,
                  type: type
               });
               
               let url;
               let options = {};
               
               if (dnsApi.provider === 'cloudflare') {
                  url = endpoint;
                  options = {
                     method: 'GET',
                     headers: {
                        'Accept': 'application/dns-json'
                     }
                  };
                  
                  // Add search params to URL for Cloudflare
                  url = `${url}?${searchParams.toString()}`;
               } else {
                  // Google DNS API
                  url = `${endpoint}?${searchParams.toString()}`;
               }
               
               // Add a timeout to prevent hanging requests
               const controller = new AbortController();
               const timeoutId = setTimeout(() => controller.abort(), 5000);
               options.signal = controller.signal;
               
               const response = await fetch(url, options);
               clearTimeout(timeoutId);
               
               if (!response.ok) {
                  throw new Error(`HTTP error! Status: ${response.status}`);
               }
               
               const data = await response.json();
               
               if (data && data.Answer && data.Answer.length > 0) {
                  data.Answer.forEach(answer => {
                     // Convert the record data based on type
                     let recordValue = answer.data;
                     let recordPriority = null;
                     
                     // Remove quotes from TXT records if present
                     if (type === 'TXT' && recordValue.startsWith('"') && recordValue.endsWith('"')) {
                        recordValue = recordValue.slice(1, -1);
                     }
                     
                     // Handle multi-segment TXT records by removing quotes and spaces
                     if (type === 'TXT' && recordValue.includes('" "')) {
                        recordValue = recordValue.replace(/"\s+"/g, '');
                     }
                     
                     // Format MX records
                     if (type === 'MX' && recordValue.includes(' ')) {
                        const parts = recordValue.split(' ');
                        recordPriority = parseInt(parts[0], 10);
                        recordValue = parts.slice(1).join(' ');
                     }
                     
                     // Detect and mark special records
                     let recordPurpose = purpose;
                     if (!recordPurpose && type === 'TXT') {
                        if (recordValue.includes('v=spf1')) {
                           recordPurpose = 'SPF';
                        } else if (domain.startsWith('_dmarc.') && recordValue.includes('v=DMARC1')) {
                           recordPurpose = 'DMARC';
                        } else if (domain.includes('._domainkey.') && recordValue.includes('v=DKIM1')) {
                           recordPurpose = 'DKIM';
                        }
                     }
                     
                     // Add to records array
                     recordsArray.push({
                        type: type,
                        name: domain,
                        value: recordValue,
                        ttl: answer.TTL,
                        priority: recordPriority,
                        purpose: recordPurpose
                     });
                  });
               } else if (data && data.Status === 3) { // NXDOMAIN status
                  // Add record with "not found" status only for DKIM/DMARC
                  if (purpose === 'DKIM' || purpose === 'DMARC') {
                     recordsArray.push({
                        type: type,
                        name: domain,
                        value: `No record found (NXDomain)`,
                        ttl: 0,
                        purpose: purpose,
                        status: 'missing'
                     });
                  }
               } else if (data && data.Status !== 0) {
                  // Add record with failure status
                  recordsArray.push({
                     type: type,
                     name: domain,
                     value: `No record found (Status: ${data.Status})`,
                     ttl: 0,
                     purpose: purpose,
                     status: 'missing'
                  });
               }
               
               return recordsArray;
            } catch (error) {
               console.error(`Error fetching ${type} records for ${domain}:`, error);
               
               // Add record with error
               recordsArray.push({
                  type: type,
                  name: domain,
                  value: `Error: ${error.message}`,
                  ttl: 0,
                  status: 'error',
                  purpose: purpose
               });
               
               return recordsArray;
            }
         }
         
         function generateRecommendations(records, domain) {
            const recommendations = [];
            
            // Check for SPF record
            const spfRecord = records.find(r => r.type === 'TXT' && r.value.includes('v=spf1'));
            if (!spfRecord) {
               recommendations.push({
                  severity: 'error',
                  title: 'Missing SPF Record',
                  description: 'Your domain lacks an SPF record, which helps prevent email spoofing.',
                  recommendation: 'Add a TXT record with a value like: v=spf1 mx ip4:YOUR_SERVER_IP -all'
               });
            } else if (spfRecord.value.includes('~all')) {
               recommendations.push({
                  severity: 'warning',
                  title: 'Soft-fail SPF Policy',
                  description: 'Your SPF record uses a soft fail (~all) instead of a hard fail.',
                  recommendation: 'Consider changing ~all to -all for stronger protection against email spoofing.'
               });
            } else if (spfRecord.value.includes('-all')) {
               recommendations.push({
                  severity: 'success',
                  title: 'Strong SPF Policy',
                  description: 'Your domain has a properly configured SPF record with a hard fail policy.',
                  recommendation: 'Maintain this configuration and regularly review authorized senders.'
               });
            }
            
            // Check for DMARC record
            const dmarcRecord = records.find(r => r.type === 'TXT' && r.name.startsWith('_dmarc.') && r.value.includes('v=DMARC1'));
            if (!dmarcRecord) {
               recommendations.push({
                  severity: 'error',
                  title: 'Missing DMARC Record',
                  description: 'Your domain lacks a DMARC record, which adds another layer of email authentication.',
                  recommendation: 'Add a TXT record at _dmarc.' + domain + ' with a value like: v=DMARC1; p=none; rua=mailto:dmarc@' + domain
               });
            } else if (dmarcRecord.value.includes('p=none')) {
               recommendations.push({
                  severity: 'warning',
                  title: 'DMARC Monitor Only Mode',
                  description: 'Your DMARC policy is set to none (monitoring mode only).',
                  recommendation: 'After monitoring for a while, consider increasing protection by changing to p=quarantine or p=reject.'
               });
            } else if (dmarcRecord.value.includes('p=quarantine') || dmarcRecord.value.includes('p=reject')) {
               recommendations.push({
                  severity: 'success',
                  title: 'Strong DMARC Policy',
                  description: 'Your domain has an enforced DMARC policy, which provides good email protection.',
                  recommendation: 'Continue monitoring DMARC reports for any legitimate email delivery issues.'
               });
            }
            
            // Check for DKIM records
            const dkimRecords = records.filter(r => 
               r.type === 'TXT' && 
               r.name.includes('._domainkey.') && 
               r.value.includes('v=DKIM1') &&
               !r.status // Only count valid records
            );
            
            const dkimMissingRecords = records.filter(r => 
               r.purpose === 'DKIM' && 
               r.status === 'missing'
            );
            
            // Check DKIM setup
            if (dkimRecords.length === 0) {
               recommendations.push({
                  severity: 'error',
                  title: 'Missing DKIM Records',
                  description: 'Your domain lacks DKIM records, which are essential for email authentication.',
                  recommendation: `Implement DKIM by generating key pairs and adding TXT records with selectors at hostname: *._domainkey. Common selectors include "default", "google", "selector1", or "selector2".`
               });
            } else {
               // Check for DKIM key strength
               let weakKeyFound = false;
               let keyWithoutVersion = false;
               
               dkimRecords.forEach(record => {
                  // Check if p= value exists and is too short (weak key)
                  const pMatch = record.value.match(/p=([A-Za-z0-9+/=]+)/);
                  if (pMatch) {
                     const keyLength = pMatch[1].length;
                     if (keyLength < 300) { // Approximate check for weak keys
                        weakKeyFound = true;
                     }
                  } else {
                     keyWithoutVersion = true;
                  }
               });
               
               if (weakKeyFound) {
                  recommendations.push({
                     severity: 'warning',
                     title: 'Weak DKIM Key',
                     description: 'One or more of your DKIM keys appears to be using an older, less secure key length.',
                     recommendation: 'Update your DKIM keys to use at least 2048-bit RSA keys for stronger security.'
                  });
               } else if (keyWithoutVersion) {
                  recommendations.push({
                     severity: 'warning',
                     title: 'Malformed DKIM Record',
                     description: 'One or more DKIM records appear to be missing the public key value.',
                     recommendation: 'Check your DKIM record format. It should contain "v=DKIM1", "k=rsa", and "p=" followed by the public key.'
                  });
               } else {
                  recommendations.push({
                     severity: 'success',
                     title: 'DKIM Records Properly Configured',
                     description: `Found ${dkimRecords.length} valid DKIM record${dkimRecords.length > 1 ? 's' : ''} for your domain.`,
                     recommendation: 'Regularly rotate your DKIM keys (recommended every 6-12 months) to maintain security.'
                  });
               }
               
               // If we had missing selectors but some were valid
               if (dkimMissingRecords.length > 0 && dkimRecords.length > 0) {
                  recommendations.push({
                     severity: 'info',
                     title: 'Some DKIM Selectors Not Found',
                     description: `${dkimMissingRecords.length} DKIM selector${dkimMissingRecords.length > 1 ? 's' : ''} did not return a valid record.`,
                     recommendation: 'This is not necessarily a problem if those selectors are not used for your email sending services.'
                  });
               }
            }
            
            // Check for CNAME at apex
            const cnameAtApex = records.find(r => 
               r.type === 'CNAME' && 
               !r.name.includes('.') && 
               !r.status
            );
            
            if (cnameAtApex) {
               recommendations.push({
                  severity: 'warning',
                  title: 'CNAME at Domain Apex',
                  description: 'You have a CNAME record at your domain apex (root domain). This is technically not allowed by DNS standards.',
                  recommendation: 'Consider using A records at your domain apex instead of a CNAME. Many DNS providers now offer ANAME/ALIAS record types as alternatives.'
               });
            }
            
            // Check NS record count for redundancy
            const nsRecords = records.filter(r => r.type === 'NS');
            if (nsRecords.length < 2) {
               recommendations.push({
                  severity: 'warning',
                  title: 'Limited Name Server Redundancy',
                  description: 'Your domain has fewer than 2 name servers, which reduces DNS redundancy.',
                  recommendation: 'Add at least one more name server to improve reliability and fault tolerance.'
               });
            }
            
            // Additional generic recommendations
            recommendations.push({
               severity: 'info',
               title: 'Consider DNSSEC Implementation',
               description: 'DNSSEC adds cryptographic signatures to DNS records to prevent tampering.',
               recommendation: 'Contact your domain registrar about enabling DNSSEC for your domain.'
            });
            
            return recommendations;
         }
         
         function displayDnsResults(data) {
            // Clear previous results
            recordsList.innerHTML = '';
            recommendationsList.innerHTML = '';
            rawData.textContent = JSON.stringify(data, null, 2);
            
            // Display records
            if (data.records.length === 0) {
               recordsList.innerHTML = '<p style="text-align: center;">No DNS records found for the selected type.</p>';
            } else {
               // Center the records list container itself
               recordsList.style.textAlign = 'center';
               
               // Group records by type for better presentation
               const recordsByType = {};
               
               data.records.forEach(record => {
                  // Skip displaying records marked as missing
                  if (record.status === 'missing') return;
                  
                  const type = record.purpose || record.type;
                  if (!recordsByType[type]) {
                     recordsByType[type] = [];
                  }
                  recordsByType[type].push(record);
               });
               
               // Display records by type
               for (const [type, typeRecords] of Object.entries(recordsByType)) {
                  const typeHeading = document.createElement('h4');
                  typeHeading.textContent = type;
                  typeHeading.style.marginTop = '20px';
                  typeHeading.style.color = '#00f0ff';
                  typeHeading.style.textAlign = 'center';
                  recordsList.appendChild(typeHeading);
                  
                  typeRecords.forEach(record => {
                     const recordElement = document.createElement('div');
                     recordElement.className = 'record-item';
                     
                     if (record.status === 'error') {
                        recordElement.classList.add('error-record');
                     } else if (record.status === 'info') {
                        recordElement.classList.add('info-record');
                     }
                     
                     let recordContent = `
                        <p><strong>Name:</strong> ${record.name}</p>
                     `;
                     
                     if (record.ttl > 0) {
                        recordContent += `<p><strong>TTL:</strong> ${record.ttl} seconds</p>`;
                     }
                     
                     recordContent += `
                        <p><strong>Value:</strong></p>
                        <div class="record-value">${record.value || "Not found"}</div>
                     `;
                     
                     if (record.priority) {
                        recordContent += `<p><strong>Priority:</strong> ${record.priority}</p>`;
                     }
                     
                     recordElement.innerHTML = recordContent;
                     recordsList.appendChild(recordElement);
                  });
               }
            }
            
            // Display recommendations
            if (data.recommendations.length === 0) {
               recommendationsList.innerHTML = '<p style="text-align: center;">No recommendations available.</p>';
            } else {
               // Center the recommendations list container itself
               recommendationsList.style.textAlign = 'center';
               
               data.recommendations.forEach(rec => {
                  const recElement = document.createElement('div');
                  recElement.className = 'recommendation-item';
                  
                  let iconClass = 'info';
                  let icon = 'â„¹ï¸';
                  
                  if (rec.severity === 'error') {
                     iconClass = 'error';
                     icon = 'âš ï¸';
                  } else if (rec.severity === 'warning') {
                     iconClass = 'warning';
                     icon = 'âš ï¸';
                  } else if (rec.severity === 'success') {
                     iconClass = 'success';
                     icon = 'âœ…';
                  }
                  
                  recElement.innerHTML = `
                     <div class="recommendation-icon ${iconClass}">${icon}</div>
                     <div class="recommendation-content">
                        <h4>${rec.title}</h4>
                        <p>${rec.description}</p>
                        <p><strong>Recommendation:</strong><br>${rec.recommendation}</p>
                     </div>
                  `;
                  
                  recommendationsList.appendChild(recElement);
               });
            }
         }
         
         // Append styles for record types
         const additionalStyles = document.createElement('style');
         additionalStyles.textContent = `
            .error-record {
               border-left: 3px solid #ff4d4d;
            }
            
            .info-record {
               border-left: 3px solid #00f0ff;
            }
            
            /* Improve record display */
            .record-value {
               font-family: monospace;
               background: rgba(0, 0, 0, 0.4);
               padding: 8px;
               border-radius: 4px;
               overflow-wrap: break-word;
               white-space: pre-wrap; /* Preserve formatting for long DNS records */
               max-height: 200px;
               overflow-y: auto; /* Add scrolling for very long records */
               text-align: left; /* Keep code content left-aligned for readability */
            }
            
            /* Center tabs */
            .tabs {
               justify-content: center;
            }
            
            /* Ensure tab content is centered */
            .tab-content h3 {
               text-align: center;
            }
            
            #dns-results {
               text-align: center;
            }
            
            #raw-tab {
               text-align: center;
            }
            
            #raw-data {
               margin: 0 auto;
               text-align: left; /* Keep raw data left-aligned for readability */
            }
         `;
         document.head.appendChild(additionalStyles);
         
         // Add quick selector functionality for DKIM selectors
         document.querySelectorAll('.quick-selector').forEach(selector => {
            selector.addEventListener('click', function() {
               const selectorValue = this.dataset.selector;
               if (!dkimSelectors.includes(selectorValue)) {
                  dkimSelectors.push(selectorValue);
                  renderDkimSelectors();
                  
                  // Visual feedback when clicked
                  this.style.backgroundColor = 'rgba(0, 240, 255, 0.3)';
                  setTimeout(() => {
                     this.style.backgroundColor = '';
                  }, 300);
               }
            });
         });
      });
   </script>
</section>

</body>
</html>
